NAME=agCj entry0 imports libc_start_main
FILE=bins/elf/true
CMDS=<<EOF
aaa 2> /dev/null
agCj~{nodes[0]}
EOF
EXPECT=<<EOF
{"id":0,"title":"entry0","body":"","out_nodes":[1]}
EOF
RUN

NAME=agCd entry0 imports libc_start_main
FILE=bins/elf/true
CMDS=<<EOF
aaa 2> /dev/null
agCd~entry0
EOF
EXPECT=<<EOF
"entry0" [URL="entry0", color="lightgray", label="entry0"]
"entry0" -> "reloc.__libc_start_main"
EOF
RUN

NAME=agCd contains label for main
FILE=bins/elf/true
CMDS=<<EOF
aaa 2> /dev/null
agCd~label="main"
EOF
EXPECT=<<EOF
"main" [URL="main", color="lightgray", label="main"]
EOF
RUN

NAME=agC function names are resovled properly
FILE=bins/elf/true
CMDS=<<EOF
aaa 2> /dev/null
agC~unk.
echo end
EOF
EXPECT=<<EOF
end
EOF
RUN
